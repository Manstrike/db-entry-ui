(this["webpackJsonpdb-entry-frontend"]=this["webpackJsonpdb-entry-frontend"]||[]).push([[0],{104:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(9),l=a.n(o),s=(a(84),a(11)),c=a(12),r=a(15),h=a(14),u=a(13),m=(a(85),"https://db-entry.herokuapp.com"),d=a(10),p=a(147),b=a(144),f=a(157),g=a(56),v=a(140),y=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={login:"",password:""},n._onClick=e.onClick,n._handleClick=n._handleClick.bind(Object(r.a)(n)),n._onLoginChanged=n._onLoginChanged.bind(Object(r.a)(n)),n._onPasswordChanged=n._onPasswordChanged.bind(Object(r.a)(n)),n}return Object(c.a)(a,[{key:"_handleClick",value:function(e){var t=this;if(e.preventDefault(),this.state.login&&this.state.password){var a={login:this.state.login,password:this.state.password};fetch("".concat(m,"/user/login"),{method:"POST",body:JSON.stringify({name:a.login}),headers:{"Content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log({result:e}),e&&t._onClick(a,e)}))}}},{key:"_onLoginChanged",value:function(e){this.setState({login:e.target.value})}},{key:"_onPasswordChanged",value:function(e){this.setState({password:e.target.value})}},{key:"render",value:function(){return i.a.createElement(v.a,{component:"main",maxWidth:"xs"},i.a.createElement(b.a,null),i.a.createElement("div",{className:"someClass"},i.a.createElement(g.a,{component:"h1",variant:"h5"},"Sign in"),i.a.createElement("form",{className:"somClass",noValidate:!0},i.a.createElement(f.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"login",label:"Login",name:"login",autoComplete:"login",autoFocus:!0,onChange:this._onLoginChanged}),i.a.createElement(f.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:this._onPasswordChanged}),i.a.createElement(p.a,{type:"button",fullWidth:!0,variant:"contained",color:"primary",className:"cssdds",onClick:this._handleClick},"Sign In"))))}}]),a}(i.a.Component),C=a(31),E=a(37),j=(a(89),a(21)),k=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return i.a.createElement(v.a,{component:"main",maxWidth:"xs"},i.a.createElement(b.a,null),i.a.createElement("div",null,i.a.createElement(p.a,{type:"button",fullWidth:!0,variant:"contained",color:"primary",className:"navButton",component:j.b,to:"/school/create"},"Create School"),i.a.createElement(p.a,{fullWidth:!0,type:"button",variant:"contained",color:"primary",className:"navButton",component:j.b,to:"/admin"},"Admin Panel")))}}]),a}(i.a.Component),O=a(33),_=a(146),S=a(105),N=a(148),w=a(149),I=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={},n}return Object(c.a)(a,[{key:"_handleClick",value:function(e){this.setState(Object(O.a)({},e,!this.state[e]))}},{key:"render",value:function(){var e=this,t=this.props.entries;return console.log({entries:t}),i.a.createElement("div",{className:"entry-list-wrapper"},i.a.createElement(_.a,null,t.map((function(t){return i.a.createElement("div",{key:t.id},t.buildingsList.length>0?i.a.createElement("div",{key:t.id},i.a.createElement(S.a,{button:!0,key:t.id,onClick:e._handleClick.bind(e,t.name)},i.a.createElement(N.a,{primary:t.name})),i.a.createElement(w.a,{key:t.id,component:"li",in:e.state[t.name],timeput:"auto",unmountOnExit:!0},i.a.createElement(_.a,{disablePadding:!0,className:"entry-item",margin:"normal"},t.buildingsList.map((function(e){return i.a.createElement(S.a,{button:!0,component:j.b,to:"/teacher/create?building=".concat(e.id,"&school=").concat(t.id),key:e.id},i.a.createElement(N.a,{key:e.id,primary:e.building_name}))}))))):i.a.createElement(S.a,{button:!0,component:j.b,to:"/teacher/create?school=".concat(t.id),key:t.id},i.a.createElement(N.a,{primary:t.name})))}))))}}]),a}(i.a.Component),W=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={entries:[]},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this._fetchSchools()}},{key:"_fetchSchools",value:function(){var e,t=this;fetch("".concat(m,"/school/all")).then((function(e){return e.json()})).then((function(t){return e=t,fetch("".concat(m,"/school/communities"))})).then((function(e){return e.json()})).then((function(a){e=e.map((function(e,t){var n=a.find((function(t){return t.id===e.community}));return Object(E.a)(Object(E.a)({},e),{},{name:"".concat(n.name,", ").concat(e.city," - ").concat(e.level)})})),t.setState({entries:Object(C.a)(e)})}))}},{key:"render",value:function(){var e=this.props.history,t=this.state.entries;return i.a.createElement("div",{className:"home-page"},i.a.createElement(I,{entries:t}),i.a.createElement(k,{history:e}))}}]),a}(i.a.Component),B=a(151),x=a(155),P=a(154),L=a(150),D=a(152),T=a(153),q=a(145),A=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return i.a.createElement(L.a,{component:q.a},i.a.createElement(B.a,null,i.a.createElement(D.a,null,i.a.createElement(T.a,null,i.a.createElement(P.a,null,"Username"),i.a.createElement(P.a,{align:"right"},"Password"))),i.a.createElement(x.a,null,this.props.users.map((function(e,t){return i.a.createElement(T.a,{key:t},i.a.createElement(P.a,{component:"th",scope:"row"},e.name),i.a.createElement(P.a,{align:"right"},e.password))})))))}}]),a}(i.a.Component),M=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),n=t.call(this,e);var i=JSON.parse(localStorage.getItem("user"));return n.state={nameInput:"",passwordInput:"",users:[],userAllowedAccess:"admin"===i.role},n.handleButtonClick=n._handleButtonClick.bind(Object(r.a)(n)),n.onNameChange=n._onNameChange.bind(Object(r.a)(n)),n.onPassChange=n._onPassChange.bind(Object(r.a)(n)),n}return Object(c.a)(a,[{key:"_handleButtonClick",value:function(e){var t=this;if(e.preventDefault(),""!==this.state.nameInput&&""!==this.state.passwordInput){var a=Object(C.a)(this.state.users),n={name:this.state.nameInput,password:this.state.passwordInput};fetch("".concat(m,"/user/create"),{method:"POST",body:JSON.stringify(n),headers:{"Content-type":"application/json"}}).then((function(e){return e})).then((function(e){console.log({result:e}),200===e.status&&(a.push(n),t.setState(Object(E.a)(Object(E.a)({},t.state),{},{users:Object(C.a)(a),nameInput:"",passwordInput:""})))}))}}},{key:"_onNameChange",value:function(e){this.setState({nameInput:e.target.value})}},{key:"_onPassChange",value:function(e){this.setState({passwordInput:e.target.value})}},{key:"render",value:function(){return this.state.userAllowedAccess?i.a.createElement(v.a,{component:"main",maxWidth:"xs"},i.a.createElement(b.a,null),i.a.createElement(g.a,{component:"h1",variant:"h5"},"Admin Panel"),i.a.createElement(f.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"login",label:"Login",name:"login",autoFocus:!0,onChange:this.onNameChange,value:this.state.nameInput}),i.a.createElement(f.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",id:"password",value:this.state.passwordInput,onChange:this.onPassChange}),i.a.createElement(p.a,{type:"button",fullWidth:!0,variant:"contained",color:"primary",onClick:this.handleButtonClick},"Create user"),i.a.createElement(A,{users:this.state.users})):null}}]),a}(i.a.Component),J=a(156),K=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={communitiesList:[],level:"",community:"(ORS)",street:"",postalCode:"",city:"",email:"",website:"",schoolBuildings:""},n.onClick=n._onClick.bind(Object(r.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this._fetchCommunities()}},{key:"_fetchCommunities",value:function(){var e=this;fetch("".concat(m,"/school/communities")).then((function(e){return e.json()})).then((function(t){e.setState({communitiesList:Object(C.a)(t)})}))}},{key:"_onChange",value:function(e,t){this.setState(Object(O.a)({},e,t.target.value))}},{key:"_onClick",value:function(e){var t=this;if(e.preventDefault(),""!==this.state.level&&""!==this.state.community&&""!==this.state.street&&""!==this.state.postalCode&&""!==this.state.city&&""!==this.state.email){var a={level:this.state.level,community:this.state.community,street:this.state.street,postalCode:this.state.postalCode,city:this.state.city,email:this.state.email,website:this.state.website,schoolBuildings:this.state.schoolBuildings.split(",")};fetch("".concat(m,"/school/create"),{method:"POST",body:JSON.stringify(a),headers:{"Content-type":"application/json"}}).then((function(e){200===e.status&&t.setState({level:"",community:"",street:"",postalCode:"",city:"",email:"",website:"",schoolBuildings:""})}))}}},{key:"render",value:function(){var e=this.state.communitiesList;return i.a.createElement(v.a,{component:"main",maxWidth:"xs"},i.a.createElement(b.a,null),i.a.createElement(g.a,{component:"h1",variant:"h5"},"Create School"),i.a.createElement(f.a,{label:"School Level",fullWidth:!0,required:!0,margin:"normal",value:this.state.level,onChange:this._onChange.bind(this,"level")}),i.a.createElement(f.a,{label:"Community",select:!0,fullWidth:!0,required:!0,margin:"normal",value:this.state.community,onChange:this._onChange.bind(this,"community")},e.map((function(e,t){return i.a.createElement(J.a,{key:t,value:e.id},e.name)}))),i.a.createElement(f.a,{label:"Street",fullWidth:!0,required:!0,margin:"normal",value:this.state.street,onChange:this._onChange.bind(this,"street")}),i.a.createElement(f.a,{label:"Postal Code",fullWidth:!0,required:!0,margin:"normal",value:this.state.postalCode,onChange:this._onChange.bind(this,"postalCode")}),i.a.createElement(f.a,{label:"City",fullWidth:!0,required:!0,margin:"normal",value:this.state.city,onChange:this._onChange.bind(this,"city")}),i.a.createElement(f.a,{label:"Email",fullWidth:!0,required:!0,margin:"normal",value:this.state.email,onChange:this._onChange.bind(this,"email")}),i.a.createElement(f.a,{label:"Website",fullWidth:!0,margin:"normal",value:this.state.website,onChange:this._onChange.bind(this,"website")}),i.a.createElement(f.a,{label:"School Buildings",fullWidth:!0,margin:"normal",value:this.state.schoolBuildings,onChange:this._onChange.bind(this,"schoolBuildings")}),i.a.createElement(p.a,{type:"submit",color:"primary",variant:"contained",margin:"normal",onClick:this.onClick},"Save"))}}]),a}(i.a.Component),F=a(38),R=a(55),U=a.n(R),V=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e))._onClick=e.onClick,n}return Object(c.a)(a,[{key:"_handleTeacherClick",value:function(e){this._onClick(e)}},{key:"render",value:function(){var e=this,t=this.props,a=t.entries,n=t.school;return i.a.createElement("div",{className:"entry-list-wrapper"},i.a.createElement("h2",null,n?"".concat(n.community,", ").concat(n.city," - ").concat(n.level):""),i.a.createElement("div",null,i.a.createElement(_.a,null,a.map((function(t){return i.a.createElement("div",{key:t.id},i.a.createElement(S.a,{button:!0,onClick:e._handleTeacherClick.bind(e,t),key:t.id},i.a.createElement(N.a,{primary:"[".concat(t.gender,"] ").concat(t.firstName," ").concat(t.secondName)})))})))))}}]),a}(i.a.Component),z=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={id:null,firstName:"",secondName:"",email:"",gender:"",school:null,schoolBuilding:"",subject:"",position:"",teacherList:[],schoolId:null,buildingId:null},n.firstNameChanged=n._firstNameChanged.bind(Object(r.a)(n)),n.secondNameChanged=n._secondNameChanged.bind(Object(r.a)(n)),n.emailChanged=n._emailChanged.bind(Object(r.a)(n)),n.handleTeacherAdding=n._handleTeacherAdding.bind(Object(r.a)(n)),n.handleKeyDown=n._handleKeyDown.bind(Object(r.a)(n)),n}return Object(c.a)(a,[{key:"_handleTeacherClick",value:function(e){e&&this.setState({id:e.id,firstName:e.firstName,secondName:e.secondName,email:e.email,gender:e.gender,subject:e.subject,position:e.position})}},{key:"componentWillMount",value:function(){document.addEventListener("keydown",this._handleKeyDown.bind(this),!1)}},{key:"componentDidMount",value:function(){var e=U.a.parse(this.props.location.search),t=e.school,a=e.building;this.setState({schoolId:t,buildingId:a}),this._fetchSchoolInfo(),this._fetchSchoolTeachers()}},{key:"_fetchSchoolInfo",value:function(){var e=this,t=U.a.parse(this.props.location.search).school;this.state.school||fetch("".concat(m,"/school/").concat(t)).then((function(e){return e.json()})).then((function(t){e.setState({school:t}),e._setDefaultState()})).catch((function(e){return console.log(e)}))}},{key:"_setDefaultState",value:function(){var e=this.state.school.email.split("@"),t=Object(F.a)(e,2)[1];this.setState({schoolMailDomain:"@"+t,email:".@"+t})}},{key:"_firstNameChanged",value:function(e){var t,a=e.target.value,n=this.state.email.split("@"),i=Object(F.a)(n,1)[0];if(i){var o=i.split(".");t=[a,Object(F.a)(o,2)[1]].join(".")+this.state.schoolMailDomain}else t=[a,this.state.schoolMailDomain].join(".");this.setState({firstName:a,email:t.toLowerCase()})}},{key:"_secondNameChanged",value:function(e){var t,a=e.target.value,n=this.state.email.split("@"),i=Object(F.a)(n,1)[0];if(i){var o=i.split(".");t=[Object(F.a)(o,1)[0],a].join(".")+this.state.schoolMailDomain}else t=[".",a,this.state.schoolMailDomain].join("");this.setState({secondName:a,email:t.toLowerCase()})}},{key:"_emailChanged",value:function(e){this.setState({email:e.target.value})}},{key:"_handleTeacherAdding",value:function(){var e=this;if(this.state.firstName&&this.state.secondName&&this.state.gender){var t={id:this.state.id,firstName:this.state.firstName,secondName:this.state.secondName,gender:this.state.gender,position:this.state.position,subject:this.state.subject,email:this.state.email,school:this.state.schoolId,building:this.state.buildingId};fetch("".concat(m,"/teacher/create"),{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json"}}).then((function(t){200===t.status?(e.setState({id:null,firstName:"",secondName:"",email:"",gender:"",school:"",schoolBuilding:"",subject:"",position:""}),e._fetchSchoolTeachers()):console.warn("Something wend wrong")}))}}},{key:"_handleKeyDown",value:function(e){e.ctrlKey&&"m"===e.key&&(this.setState({gender:"M"}),this._handleTeacherAdding()),e.ctrlKey&&e.altKey&&"f"===e.key&&(this.setState({gender:"F"}),this._handleTeacherAdding())}},{key:"_fetchSchoolTeachers",value:function(){var e=this,t=U.a.parse(this.props.location.search),a=t.school,n=t.building,i=n?"".concat(m,"/teacher/building/").concat(a,"/").concat(n):"".concat(m,"/teacher/school/").concat(a);fetch(i).then((function(e){return e.json()})).then((function(t){e.setState({teacherList:t})}))}},{key:"_fetchSubjects",value:function(){}},{key:"_fetchFunctions",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.teacherList,a=e.school;return i.a.createElement("div",{className:"home-page"},i.a.createElement(V,{onClick:this._handleTeacherClick.bind(this),entries:t,school:a}),i.a.createElement(v.a,{component:"main",maxWidth:"xs"},i.a.createElement(b.a,null),i.a.createElement(g.a,{component:"h1",variant:"h5"},"Create Teacher"),i.a.createElement(f.a,{label:"First Name",fullWidth:!0,required:!0,margin:"normal",value:this.state.firstName,onChange:this.firstNameChanged}),i.a.createElement(f.a,{label:"Second Name",fullWidth:!0,required:!0,margin:"normal",value:this.state.secondName,onChange:this.secondNameChanged}),i.a.createElement(f.a,{label:"Email",fullWidth:!0,required:!0,margin:"normal",value:this.state.email,onChange:this.emailChanged}),i.a.createElement(f.a,{label:"Function",select:!0,fullWidth:!0,margin:"normal"}),i.a.createElement(f.a,{label:"Subject",select:!0,fullWidth:!0,margin:"normal"})))}}]),a}(i.a.Component),G=Object(d.g)(z),H=function(e){Object(h.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.call(this)).state={redirect:!1},e._handleSignInButtonClicked=e._handleSignInButtonClicked.bind(Object(r.a)(e)),e}return Object(c.a)(a,[{key:"_handleSignInButtonClicked",value:function(e,t){var a=e.login,n=e.password;localStorage.setItem("user",JSON.stringify(t)),this.setState({redirect:n===t.password&&a===t.name})}},{key:"render",value:function(){var e=this.state.redirect,t=this.props.history;return e?i.a.createElement("div",{className:"App"},i.a.createElement(d.d,null,i.a.createElement(d.a,{exact:!0,from:"/",to:"/home",push:!0}),i.a.createElement(d.b,{exact:!0,path:"/"},i.a.createElement(y,{history:t,location:this.props.location,onClick:this._handleSignInButtonClicked})),i.a.createElement(d.b,{exact:!0,path:"/home"},i.a.createElement(W,{history:t})),i.a.createElement(d.b,{exact:!0,path:"/admin"},i.a.createElement(M,{history:t})),i.a.createElement(d.b,{path:"/school/create"},i.a.createElement(K,{history:t})),i.a.createElement(d.b,{path:"/teacher/create"},i.a.createElement(G,{history:t})))):i.a.createElement("div",{className:"App"},i.a.createElement(d.d,null,i.a.createElement(d.b,{exact:!0,path:"/"},i.a.createElement(y,{history:t,onClick:this._handleSignInButtonClicked})),e&&i.a.createElement(d.a,{to:"/home"}),i.a.createElement(d.b,{exact:!0,path:"/home"},i.a.createElement(W,{history:t})),i.a.createElement(d.b,{exact:!0,path:"/admin"},i.a.createElement(M,{history:t})),i.a.createElement(d.b,{path:"/school/create"},i.a.createElement(K,{history:t})),i.a.createElement(d.b,{path:"/teacher/create"},i.a.createElement(G,{history:t}))))}}]),a}(i.a.Component),Q=a(70),X=Object(Q.a)();l.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(j.a,{basename:"/db-entry-ui"},i.a.createElement(H,{history:X}))),document.getElementById("root"))},79:function(e,t,a){e.exports=a(104)},84:function(e,t,a){},85:function(e,t,a){},89:function(e,t,a){}},[[79,1,2]]]);
//# sourceMappingURL=main.6703e542.chunk.js.map